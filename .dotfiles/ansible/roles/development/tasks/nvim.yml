---
- name: Install bob-nvim binary
  ansible.builtin.shell:
    cmd: |
      mkdir -p ~/.local/bin
      curl -L https://github.com/MordechaiHadad/bob/releases/latest/download/bob-linux-x86_64.zip -o /tmp/bob.zip
      unzip -o /tmp/bob.zip -d ~/.local/bin
      chmod +x ~/.local/bin/bob
    creates: ~/.local/bin/bob
  become: false

- name: Install and use stable Neovim via bob
  ansible.builtin.shell:
    cmd: |
      source ~/.zprofile && bob use stable
    executable: /bin/zsh
  register: bob_use
  changed_when: "'Installed' in bob_use.stdout or 'Now using' in bob_use.stdout"
  become: false
